<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Registro de Novedades</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <div class="contenedor-principal">
    <h1>Registro de Novedades</h1>

    <label for="codigoCliente">Código de Cliente:</label>
    <input type="text" id="codigoCliente" onblur="buscarCliente()" placeholder="Ej: 123456" />

    <label for="nombreCliente">Nombre del Cliente:</label>
    <input type="text" id="nombreCliente" readonly placeholder="Nombre aparecerá aquí..." />

    <label for="novedad">Selecciona una novedad:</label>
    <select id="novedad">
      <option value="">-- Seleccionar --</option>
      <option value="NO VISITA DE EJECUTIVO">NO VISITA DE EJECUTIVO</option>
      <option value="NO HAY DEVOLUCIONES">NO HAY DEVOLUCIONES</option>
      <option value="NO HAY CAMBIOS DE PRODUCTOS">NO HAY CAMBIOS DE PRODUCTOS</option>
      <option value="CUPO LIMITADO">CUPO LIMITADO</option>
      <option value="CLIENTE BLOQUEADO">CLIENTE BLOQUEADO</option>
      <option value="SIN CREDITO">SIN CREDITO</option>
      <option value="PROBLEMA EN FRECUENCIA DE LLAMADA">PROBLEMA EN FRECUENCIA DE LLAMADA</option>
      <option value="PROBLEMAS CON DESCUENTOS">PROBLEMAS CON DESCUENTOS</option>
      <option value="BAJA ROTACION">BAJA ROTACION</option>
      <option value="NEGOCIO CERRADO">NEGOCIO CERRADO</option>
      <option value="COMPRA A LA COMPETENCIA">COMPRA A LA COMPETENCIA</option>
      <option value="PROBLEMAS CON LOGISTICA">PROBLEMAS CON LOGISTICA</option>
      <option value="PROBLEMAS DE INSUFICIENCIA">PROBLEMAS DE INSUFICIENCIA</option>
      <option value="EJECUTIVO NO ENCUENTRA AL CLIENTE">EJECUTIVO NO ENCUENTRA AL CLIENTE</option>
      <option value="TIENE OTRO CODIGO">TIENE OTRO CODIGO</option>
      <option value="PEDIDOS SIN CONSENTIMIENTO">PEDIDOS SIN CONSENTIMIENTO</option>
      <option value="POR VACACIONES">POR VACACIONES</option>
      <option value="FALTA DE AGUA">FALTA DE AGUA</option>
      <option value="CLIENTE CERRADO TOTALMENTE">CLIENTE CERRADO TOTALMENTE</option>
      <option value="DELINCUENCIA (EXTORSION, VACUNAS, SECUESTROS)">DELINCUENCIA (EXTORSION, VACUNAS, SECUESTROS)</option>
      <option value="COMPARTE CODIGO">COMPARTE CODIGO</option>
      <option value="COMPRA CADA 15 DIAS (O 1 VEZ AL MES)">COMPRA CADA 15 DIAS (O 1 VEZ AL MES)</option>
      <option value="CIERRE TEMPORAL (TEMA PERSONAL DEL CLIENTE)">CIERRE TEMPORAL (TEMA PERSONAL DEL CLIENTE)</option>
      <option value="NO CONTACTO ( TELEFONO INCORRECTO)">NO CONTACTO ( TELEFONO INCORRECTO)</option>
    </select>

    <label for="observaciones">Observaciones / Detalle:</label>
    <textarea id="observaciones" placeholder="Observaciones adicionales..."></textarea>

    <button onclick="registrarNovedad()">Registrar Novedad</button>
    <div id="mensaje"></div>
  </div>

  <!-- Botón y panel de administración -->
  <div class="admin-area">
    <button onclick="toggleAdmin()">🔒 Admin</button>

    <div id="adminLogin" style="display: none;">
      <input type="password" id="password" placeholder="Contraseña admin" />
      <button onclick="verificarAcceso()">Entrar</button>
    </div>

    <div id="adminPanel" style="display: none;">
      <h4>Subir Base del Día (.xlsx)</h4>
      <input type="file" id="inputArchivo" accept=".xlsx" />
      <button onclick="descargarExcel()">Descargar con novedades</button>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
